<md-content flex  class="md-padding" id="content">
  <div layout="row">
    <div flex-gt-sm="50" flex-sm="100">
      <h2>Stats</h2>
    </div>
    <div flex-gt-sm="50" flex-sm="100">
      <form ng-show="ctrl.getPlayersNameList().length" 
            ng-submit="$event.preventDefault()">
        <br>
        <md-autocomplete
          ng-disabled="ctrl.isDisabled"
          md-no-cache="ctrl.noCache"
          md-selected-item="ctrl.selectedItem"
          md-search-text-change="ctrl.searchTextChange(ctrl.searchText)"
          md-search-text="ctrl.searchText"
          md-selected-item-change="ctrl.selectedItemChange(item)"
          md-items="item in ctrl.querySearch(ctrl.searchText)"
          md-item-text="item.steamName"
          placeholder="Search for a player name">
          <span md-highlight-text="ctrl.searchText" md-highlight-flags="^i">{{item.steamName}}</span>
        </md-autocomplete>
        <br/>
      </form>
    </div>
  </div>
  <div layout="row" flex layout-sm="column" ng-show="ctrl.getNbPlayers() > 0">
    <md-content>
      <md-tabs md-selected="selectedIndex" md-dynamic-height md-border-bottom>
        <md-tab label="Profile">
          <md-content class="md-padding">
            <br>
            <table class="table table-striped table-bordered table-condensed">
              <thead>
                <tr>
                  <td></td>
                  <td class="tdImgPlayer" 
                      ng-repeat="player in ctrl.getPlayers() track by $index">
                    <div layout="row" layout-sm="column" 
                         layout-align="space-around">
                      <md-progress-circular ng-show="player.updating"  
                                            md-mode="indeterminate">
                      </md-progress-circular>
                    </div>
                    <img  ng-hide="player.updating"  
                          class="achievementsImgAvatar" 
                          src="{{player.avatar_medium}}"/>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr class="trOdd">
                  <td>Name</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.steam_name">
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Update state</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.update_state">
                  </td>
                </tr>
                <tr>
                  <td class="emptyRow"></td>
                </tr>
                <tr class="trOdd">
                  <td>Steam profile</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index">
                    <a href="{{player.profile_url}}">Steam profile</a>
                  </td> 
                </tr>
                <tr class="trEven">
                  <td>Time played</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="ctrl.getReadableTimePlayed(player.time_played)">
                  </td>
                </tr>
                <tr class="trOdd">
                  <td>Achievements</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index">
                    {{player.nb_achievements}} / {{ctrl.getNumberOfAchievementsTotal()}}
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Country</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.country.country_name"></td>
                </tr>
                <tr class="trOdd">
                  <td>State</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.state.state_name"></td>
                </tr>
                <tr class="trEven">
                  <td>City</td>            
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.city.city_name"></td>
                </tr>
                <tr class="trOdd">
                  <td></td>            
                  <td ng-repeat="(id, player) in ctrl.getPlayers() track by $index">
                    <md-button class="md-warn deleteButton" ng-click="ctrl.removePlayer(id)">Remove</md-button>
                  </td>
                </tr>
              </tbody>
            </table>
          </md-content>
        </md-tab>
        <md-tab label="Perks">
          <md-content class="md-padding">
            <br>
            <table class="table table-striped table-bordered table-condensed">
              <thead>
                <tr>
                  <td></td>
                  <td class="tdImgPlayer" 
                      colspan="5"
                      ng-repeat="player in ctrl.getPlayers() track by $index">
                    <div layout="row" layout-sm="column" 
                         layout-align="space-around">
                      <md-progress-circular ng-show="player.updating"  
                                            md-mode="indeterminate">
                      </md-progress-circular>
                    </div>
                    <img  ng-hide="player.updating"  
                          class="achievementsImgAvatar" 
                          src="{{player.avatar_medium}}"/>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr class="trOdd">
                  <td>Name</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index" 
                      colspan="5"
                      ng-bind="player.steam_name">
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Update state</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index" 
                      colspan="5"
                      ng-bind="player.update_state">
                  </td>
                </tr>
                <tr>
                  <td class="emptyRow" colspan="5"></td>
                </tr>
                <tr ng-repeat="(perkName, perkAchievements) in ctrl.getAchievementsPerkDifficultyList() track by $index" 
                    ng-class-odd="'trOdd'" 
                    ng-class-even="'trEven'" perk-level>
                </tr>
              </tbody>
            </table>
          </md-content>
        </md-tab>
        <md-tab label="Skills">
          <md-content class="md-padding">
            <br>
            <table class="table table-striped table-bordered table-condensed">
              <thead>
                <tr>
                  <td></td>
                  <td class="tdImgPlayer" 
                      ng-repeat="player in ctrl.getPlayers() track by $index">
                    <div layout="row" layout-sm="column" 
                         layout-align="space-around">
                      <md-progress-circular ng-show="player.updating"  
                                            md-mode="indeterminate">

                      </md-progress-circular>
                    </div>
                    <img  ng-hide="player.updating"  
                          class="achievementsImgAvatar" 
                          src="{{player.avatar_medium}}"/>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr class="trOdd">
                  <td>Name</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.steam_name">
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Update state</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.update_state">
                  </td>
                </tr>
                <tr>
                  <td class="emptyRow"></td>
                </tr>
                <tr class="trOdd">
                  <td>Medic</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      build-data="ctrl.getBuildsList().medic[player.player_stats['1_41']]"
                      build>
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Support</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      build-data="ctrl.getBuildsList().support[player.player_stats['1_21']]"
                      build>
                  </td>
                </tr>
                <tr class="trOdd">
                  <td>Commando</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      build-data="ctrl.getBuildsList().commando[player.player_stats['1_2']]"
                      build>
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Berzerk</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      build-data="ctrl.getBuildsList().berzerk[player.player_stats['1_11']]"
                      build>
                  </td>
                </tr>
                <tr class="trOdd">
                  <td>Demolitions</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      build-data="ctrl.getBuildsList().demolitions[player.player_stats['1_61']]"
                      build>
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Firebug</td>
                  <td ng-repeat="player in ctrl.getPlayers() track by $index"
                      build-data="ctrl.getBuildsList().firebug[player.player_stats['1_31']]"
                      build>
                  </td>
                </tr>

              </tbody>
            </table>
          </md-content>
        </md-tab>
        <md-tab label="Maps">
          <md-content>
            <br>
            <table class="table table-bordered table-striped tableAchivements">
              <thead>
                <tr>
                  <td></td>
                  <td class="tdImgPlayer"  colspan="4" 
                      ng-repeat="player in ctrl.getPlayers() track by $index">
                    <div layout="row" layout-sm="column" 
                         layout-align="space-around">
                      <md-progress-circular ng-show="player.updating"  
                                            md-mode="indeterminate">

                      </md-progress-circular>
                    </div>
                    <img  ng-hide="player.updating"  
                          class="achievementsImgAvatar" 
                          src="{{player.avatar_medium}}"/>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr class="trOdd">
                  <td>Name</td>
                  <td colspan="4"
                      ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.steam_name">
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Update state</td>
                  <td colspan="4" 
                      ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.update_state">
                  </td>
                </tr>
                <tr class="trOdd">
                  <td>Achievements Maps</td>
                  <td colspan="4" 
                      ng-repeat="player in ctrl.getPlayers() track by $index">
                    {{player.nb_achievements_maps}} / {{ctrl.getNumberOfAchievementsMaps()}}
                  </td>
                </tr>
                <tr>
                  <td class="emptyRow"></td>
                </tr>
                <tr ng-repeat="(mapKey, mapObject) in ctrl.getAchievementsMapsList() track by $index"  ng-class-odd="'trOdd'" ng-class-even="'trEven'"
                    achievement-map >
                </tr>
              </tbody>
            </table>
          </md-content>
        </md-tab>
        <md-tab label="Achievements">
          <md-content>
            <br>
            <table class="table table-bordered table-striped tableAchivements">
              <thead>
                <tr>
                  <td></td>
                  <td class="tdImgPlayer" 
                      ng-repeat="player in ctrl.getPlayers() track by $index">
                    <div layout="row" layout-sm="column" 
                         layout-align="space-around">
                      <md-progress-circular ng-show="player.updating"  
                                            md-mode="indeterminate">

                      </md-progress-circular>
                    </div>
                    <img  ng-hide="player.updating"  
                          class="achievementsImgAvatar" 
                          src="{{player.avatar_medium}}"/>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr class="trOdd">
                  <td>Name</td>
                  <td 
                      ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.steam_name">
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Update state</td>
                  <td 
                      ng-repeat="player in ctrl.getPlayers() track by $index"
                      ng-bind="player.update_state">
                  </td>
                </tr>
                <tr class="trOdd">
                  <td>Other Achievements</td>
                  <td 
                      ng-repeat="player in ctrl.getPlayers() track by $index">
                    {{player.nb_achievements - player.nb_achievements_maps}} / {{ctrl.getNumberOfAchievementsClassic()}}
                  </td>
                </tr>
                <tr>
                  <td class="emptyRow"></td>
                </tr>
                <tr ng-repeat="(achievemementKey, achievemementObject) in ctrl.getAchievementsClassicList() track by $index"  
                    ng-class-odd="'trOdd'" ng-class-even="'trEven'" achievement-classic>
                </tr>
              </tbody>
            </table>
          </md-content>
        </md-tab>
        <md-tab label="Stats">
          <md-content>
            <br>
            <table class="table table-bordered table-striped tableAchivements">
              <thead>
                <tr>
                  <td></td>
                  <td class="tdImgPlayer" 
                      ng-repeat="player in ctrl.getPlayers() track by $index">
                    <div layout="row" layout-sm="column" 
                         layout-align="space-around">
                      <md-progress-circular ng-show="player.updating"  
                                            md-mode="indeterminate">

                      </md-progress-circular>
                    </div>
                    <img  ng-hide="player.updating"  
                          class="achievementsImgAvatar" 
                          src="{{player.avatar_medium}}"/>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr class="trOdd">
                  <td class="statName">Name</td>
                  <td 
                    ng-repeat="player in ctrl.getPlayers() track by $index"
                    ng-bind="player.steam_name">
                  </td>
                </tr>
                <tr class="trEven">
                  <td>Update state</td>
                  <td
                    ng-repeat="player in ctrl.getPlayers() track by $index"
                    ng-bind="player.update_state">
                  </td>
                </tr>
                <tr>
                  <td class="emptyRow"></td>
                </tr>
                <tr ng-repeat="stat in ctrl.getStatsList()"  ng-class-odd="'trOdd'" ng-class-even="'trEven'"
                    stat>
                </tr>
              </tbody>
            </table>
          </md-content>
        </md-tab>
      </md-tabs>
    </md-content>
  </div>
  <div layout="row" flex layout-sm="column" ng-show="ctrl.getNbPlayers() === 0">
    <p>Add existing players to the stat page with the search bar.</p>
  </div>
</md-content>
